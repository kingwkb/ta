(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{237:function(e,t,a){e.exports=a(429)},242:function(e,t,a){},257:function(e,t){},259:function(e,t){},283:function(e,t){},323:function(e,t){},324:function(e,t){},428:function(e,t,a){},429:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),s=a.n(l),i=(a(242),a(57)),o=a(103),c=a(104),u=a(114),m=a(105),d=a(115),h=a(479),f=a(460),p=a(461),g=a(462),E=a(478),v=a(465),y=a(466),w=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target.name,n=e.target.value;a.setState(Object(i.a)({},t,n))},a.handleSubmit=function(e){localStorage.setItem("key",a.state.key),localStorage.setItem("secret",a.state.secret),a.props.onSave&&a.props.onSave()},a.handleCancel=function(e){a.props.onCancel&&a.props.onCancel()},a.handleClear=function(e){a.inputName.forEach((function(e){localStorage.removeItem(e),a.setState(Object(i.a)({},e,""))}))},a.inputName=["key","secret"],a.state={key:"",secret:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.inputName.forEach((function(t){var a=localStorage.getItem(t);a&&e.setState(Object(i.a)({},t,a))}))}},{key:"render",value:function(){return r.a.createElement(h.a,{open:!!this.props.open,onEscapeKeyDown:this.handleCancel},r.a.createElement(f.a,null,"Settings"),r.a.createElement(p.a,null,r.a.createElement(g.a,null,"Kraken API Key and Secret"),r.a.createElement(g.a,null,'Only permission with "Query Closed Orders & Trades" and "Access WebSockets API"'),r.a.createElement(g.a,{style:{color:"red"}},"DO NOT OTHER PERMISSIONS"),r.a.createElement(E.a,{label:"Key",margin:"dense",fullWidth:!0,name:"key",value:this.state.key,onChange:this.handleInputChange}),r.a.createElement(E.a,{label:"Secret",margin:"dense",fullWidth:!0,name:"secret",value:this.state.secret,onChange:this.handleInputChange})),r.a.createElement(v.a,null,r.a.createElement(y.a,{onClick:this.handleCancel},"Cancel"),r.a.createElement(y.a,{onClick:this.handleSubmit},"Save")))}}]),t}(r.a.Component),b=a(223),k=a.n(b),C=a(86),S=a.n(C),T=a(59),O=a.n(T),P=a(467),j=a(468),x=a(469),D=a(470),F=a(481),I=a(476),A=a(471),K=a(472),R=a(473),H=a(474),N=a(475),J=a(27);a(427);function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(a,!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).initKranken=function(){a.key=localStorage.getItem("key"),a.secret=localStorage.getItem("secret"),a.kraken=new k.a(a.key,a.secret,{url:"https://cors-anywhere.herokuapp.com/https://api.kraken.com"})},a.hasKey=function(){return!!a.key&&!!a.secret},a.statistic=function(){var e={};return a.trades.filter((function(e){return(!a.state.startTime||a.state.startTime>=e.time)&&(!a.state.endTime||a.state.endTime<=e.time)})).forEach((function(t){e.hasOwnProperty(t.wsname)||(e[t.wsname]={buy:{vol:O()(0),cost:O()(0),fee:O()(0)},sell:{vol:O()(0),cost:O()(0),fee:O()(0)}}),"buy"===t.type&&(e[t.wsname].buy.vol=e[t.wsname].buy.vol.plus(t.vol),e[t.wsname].buy.cost=e[t.wsname].buy.cost.plus(t.cost),e[t.wsname].buy.fee=e[t.wsname].buy.fee.plus(t.fee)),"sell"===t.type&&(e[t.wsname].sell.vol=e[t.wsname].sell.vol.plus(t.vol),e[t.wsname].sell.cost=e[t.wsname].sell.cost.plus(t.cost),e[t.wsname].sell.fee=e[t.wsname].sell.fee.plus(t.fee))})),e},a.fetchTradesData=function(){if(a.hasKey()){!1===a.state.loading&&a.setState({done:!1,loading:0,prices:{}});var e={ofs:a.state.tradesCount};a.kraken.api("TradesHistory",e,(function(e,t){if(e&&alert(e.message),t){0===a.totalTradesCount&&(console.log("data.result.count :",t.result.count),a.totalTradesCount=t.result.count,a.lastUpdateTime=S()().format());var n=Object.keys(t.result.trades);n.forEach((function(e){var n=t.result.trades[e];n.id=e,n.wsname=a.assetPairs[n.pair].wsname,a.trades.push(n)}));var r=Math.min((a.state.tradesCount+n.length)/a.totalTradesCount*100);a.setState((function(e){return{tradesCount:e.tradesCount+n.length,loading:r}})),a.state.tradesCount<a.totalTradesCount?setTimeout((function(){a.fetchTradesData()}),1500):(a.saveTradesData(),a.setState({done:!0,loading:!1}))}}))}else alert("Please setting API key and secret")},a.reloadHandler=function(e){e.preventDefault(),a.trades=[],a.totalTradesCount=0,a.setState({tradesCount:0},(function(){a.fetchTradesData()}))},a.wsConnect=function(){a.ws||(a.ws=new WebSocket("wss://ws.kraken.com/"),a.ws.onopen=function(e){var t={event:"subscribe",pair:a.getPairs(),subscription:{name:"ticker"}};a.ws.send(JSON.stringify(t))},a.ws.onmessage=function(e){var t=JSON.parse(e.data);if(Array.isArray(t)&&"ticker"===t[2]){var n=t[3],r=t[1].c[0];a.setState((function(e){return{prices:M({},e.prices,Object(i.a)({},n,r))}}))}},a.ws.onerror=function(e){a.wsClose()},a.ws.onclose=function(e){a.ws=null,setTimeout((function(){a.state.done&&a.wsConnect()}),1e3)})},a.wsClose=function(){a.ws&&a.ws.close()},a.saveTradesData=function(){localStorage.setItem("trades",JSON.stringify(a.trades)),a.wsConnect()},a.getPairs=function(){return Array.from(new Set(a.trades.map((function(e){return e.wsname}))))},a.fetchAssetPairs=function(){a.assetPairs||a.kraken.api("AssetPairs",(function(e,t){t&&(a.assetPairs=t.result,a.setState({assetPairs:!0}))}))},a.fetchAssets=function(){a.assets||a.kraken.api("Assets",(function(e,t){e&&console.log(e),t&&(a.assets=t.result,a.setState({assets:!0}))}))},a.pairItemClickHandler=function(e,t){a.setState({pair:e.target.value})},a.onTimeClickHandler=function(e,t){var n,r;t.preventDefault(),a.state.startTime?e>a.state.startTime?n=e:(n=a.state.startTime,r=e):(n=e,a.state.endTime&&n>=a.state.endTime&&(r=a.state.endTime)),a.setState({startTime:n,endTime:r})},a.clearTimeHandler=function(e){e.preventDefault(),a.setState({startTime:void 0,endTime:void 0})},a.setScrollerRef=function(e){a._windowScrollerRef=e},a.initKranken(),a.assetPairs=void 0,a.assets=void 0,a.ws=null,a.trades=localStorage.getItem("trades"),null===a.trades?a.trades=[]:a.trades=JSON.parse(a.trades),a.totalTradesCount=a.trades.length,a.state={loading:!1,settingOpen:!1,trades:a.trades,done:!!a.trades.length,pair:"",tradesCount:a.trades.length,startTime:void 0,endTime:void 0,assetPairs:!1,assets:!1,prices:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchAssetPairs(),this.state.done&&this.wsConnect()}},{key:"componentDidUpdate",value:function(e,t){t.done!==this.state.done&&(this.state.done?this.wsConnect():this.wsClose()),this._windowScrollerRef&&this._windowScrollerRef.updatePosition()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,null,r.a.createElement(w,{open:this.state.settingOpen,onCancel:function(){return e.setState({settingOpen:!1})},onSave:function(){e.setState({settingOpen:!1}),e.initKranken()}}),r.a.createElement(j.a,{container:!0,spacing:1},r.a.createElement(j.a,{item:!0},this.state.tradesCount>0&&this.state.assetPairs&&r.a.createElement(B,{data:this.getPairs(),pair:this.state.pair,onClick:this.pairItemClickHandler})),r.a.createElement(j.a,{item:!0},r.a.createElement(y.a,{variant:"contained",size:"small",onClick:function(t){e.setState({settingOpen:!0})}},"Setting")),r.a.createElement(j.a,{item:!0},r.a.createElement(y.a,{variant:"contained",size:"small",onClick:this.reloadHandler},"Fetch data"))),!1!==this.state.loading&&r.a.createElement(x.a,{variant:"determinate",value:this.state.loading||0}),this.state.tradesCount>0&&this.state.assetPairs&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{container:!0,spacing:2},r.a.createElement(j.a,{item:!0},this.state.startTime&&"Start: "+S.a.unix(this.state.startTime).format()+" "),r.a.createElement(j.a,{item:!0},this.state.endTime&&"End: "+S.a.unix(this.state.endTime).format()+" "),r.a.createElement(j.a,{item:!0},(this.state.startTime||this.state.endTime)&&r.a.createElement("a",{href:"/",onClick:this.clearTimeHandler},"Clear"))),r.a.createElement(U,{pair:this.state.pair,data:this.statistic(),prices:this.state.prices}),r.a.createElement(_,{scrollerRef:this.setScrollerRef,pair:this.state.pair,data:this.trades,onTimeClick:this.onTimeClickHandler}))))}}]),t}(n.Component);function _(e){var t=e.data,a=e.pair;return a&&(t=t.filter((function(e){return e.wsname===a}))),r.a.createElement(J.d,{ref:e.scrollerRef},(function(a){var n=a.height,l=a.isScrolling,s=(a.registerChild,a.onChildScroll),i=a.scrollTop;return r.a.createElement(J.a,{disableHeight:!0},(function(a){var o=a.width;return r.a.createElement(J.c,{autoHeight:!0,isScrolling:l,onScroll:s,scrollTop:i,width:o,height:n,headerHeight:20,rowHeight:30,rowCount:t.length,rowGetter:function(e){var a=e.index;return t[a]}},r.a.createElement(J.b,{dataKey:"index",width:30,cellRenderer:function(e){return e.rowIndex}}),r.a.createElement(J.b,{label:"Time",dataKey:"time",cellRenderer:function(t){var a=t.cellData;return r.a.createElement(D.a,{href:"#",onClick:function(t){return e.onTimeClick(a,t)}},S.a.unix(a).format())},width:210}),r.a.createElement(J.b,{label:"Pair",dataKey:"wsname",width:100}),r.a.createElement(J.b,{label:"Type",dataKey:"type",width:30}),r.a.createElement(J.b,{label:"OrderType",dataKey:"ordertype",width:100}),r.a.createElement(J.b,{style:{textAlign:"right"},label:"Price",dataKey:"price",width:100,cellRenderer:function(e){return G(e.cellData)}}),r.a.createElement(J.b,{style:{textAlign:"right"},label:"Vol",dataKey:"vol",width:130,cellRenderer:function(e){return G(e.cellData)}}),r.a.createElement(J.b,{style:{textAlign:"right"},label:"Cost",dataKey:"cost",width:130,cellRenderer:function(e){return G(e.cellData)}}),r.a.createElement(J.b,{style:{textAlign:"right"},label:"Fee",dataKey:"fee",width:100,cellRenderer:function(e){return G(e.cellData)}}),r.a.createElement(J.b,{style:{textAlign:"right"},label:"Margin",dataKey:"margin",width:100,cellRenderer:function(e){return G(e.cellData)}}))}))}))}function B(e){var t=e.data.map((function(e){return r.a.createElement(F.a,{key:e,value:e},e)}));return t.unshift(r.a.createElement(F.a,{key:"none",value:""},"All Paris")),r.a.createElement(I.a,{onChange:e.onClick,value:e.pair,displayEmpty:!0},t)}function U(e){var t=e.pair,a=e.prices,n={};""===t?n=e.data:n[t]=e.data[t];var l=Object.keys(n).map((function(e){return r.a.createElement($,{key:e,pair:e,data:n[e],price:a[e]})}));return r.a.createElement(A.a,{size:"small"},r.a.createElement(K.a,null,r.a.createElement(R.a,null,r.a.createElement(H.a,null),r.a.createElement(H.a,null,"type"),r.a.createElement(H.a,null,"vol"),r.a.createElement(H.a,null,"cost"),r.a.createElement(H.a,null,"fee"),r.a.createElement(H.a,{title:"average price"},"price (A)"),r.a.createElement(H.a,null,"price (Now)"),r.a.createElement(H.a,null,"value"),r.a.createElement(H.a,null,"profit"))),r.a.createElement(N.a,null,l))}function $(e){var t=e.pair,a=e.data,n=parseFloat(e.price);if(!a)return null;var l={vol:a.buy.vol.minus(a.sell.vol),cost:a.buy.cost.minus(a.sell.cost),fee:a.buy.fee.plus(a.sell.fee)};return l.price=l.cost.div(l.vol),r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,null,r.a.createElement(H.a,{rowSpan:"3"},t),r.a.createElement(H.a,null,"buy"),r.a.createElement(H.a,{align:"right"},G(a.buy.vol.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.buy.cost.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.buy.fee.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.buy.cost.div(a.buy.vol).toFixed(5))),r.a.createElement(H.a,null),r.a.createElement(H.a,null),r.a.createElement(H.a,null)),r.a.createElement(R.a,null,r.a.createElement(H.a,null,"sell"),r.a.createElement(H.a,{align:"right"},G(a.sell.vol.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.sell.cost.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.sell.fee.toFixed())),r.a.createElement(H.a,{align:"right"},G(a.sell.cost.div(a.sell.vol).toFixed(5))),r.a.createElement(H.a,null),r.a.createElement(H.a,null),r.a.createElement(H.a,null)),r.a.createElement(R.a,null,r.a.createElement(H.a,null,"hold"),r.a.createElement(H.a,{align:"right"},G(l.vol.toFixed())),r.a.createElement(H.a,{align:"right"},G(l.cost.toFixed())),r.a.createElement(H.a,{align:"right"},G(l.fee.toFixed())),r.a.createElement(H.a,{align:"right"},G(l.price.toFixed(5))),r.a.createElement(H.a,{align:"right"},G(n.toFixed(5))),r.a.createElement(H.a,{align:"right"},G((l.vol*n).toFixed(5))),r.a.createElement(H.a,{align:"right"},G((l.vol*n-l.cost).toFixed(5)))))}function G(e){if(void 0===e||isNaN(e)||0===parseFloat(e))return"-";var t=e.toString().split(".");return t[0]=t[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),t.join(".")}a(428);var Q=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[237,1,2]]]);
//# sourceMappingURL=main.73b2be72.chunk.js.map